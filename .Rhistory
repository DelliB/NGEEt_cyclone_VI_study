color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-25, 25)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -15.5,
label = c("Australia")) +
annotate("text", x = -105, y = 21.5,
label = c("Mexico")) +
annotate("text", x = -65, y = 16,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 26.3,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 20,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-25, 25)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-25, 25)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 12, height = 6,
path = data_directory, dpi = 300, units = "in")
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -14,
label = c("Australia")) +
annotate("text", x = -105, y = 22,
label = c("Mexico")) +
annotate("text", x = -65, y = 15,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 26.5,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 19.5,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -13.5,
label = c("Australia")) +
annotate("text", x = -105, y = 23,
label = c("Mexico")) +
annotate("text", x = -65, y = 14.5,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 26.7,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 19.3,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -13.5,
label = c("Australia")) +
annotate("text", x = -105, y = 23.5,
label = c("Mexico")) +
annotate("text", x = -65, y = 14.5,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 19,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27, 27)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -13.5,
label = c("Australia")) +
annotate("text", x = -105, y = 23.8,
label = c("Mexico")) +
annotate("text", x = -65, y = 14.5,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27.3,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 18.5,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -13,
label = c("Australia")) +
annotate("text", x = -105, y = 23.8,
label = c("Mexico")) +
annotate("text", x = -65, y = 14,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27.5,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 18,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# LAI
#LAI_data <- circleRepelLayout(VIs_sites, xlim = limits, ylim = limits)
LAI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = change_annual_LAI_500m*100),
size = 4, alpha = 0.95, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PLAI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue") +
annotate("text", x = 148, y = -13,
label = c("Australia")) +
annotate("text", x = -105, y = 23.8,
label = c("Mexico")) +
annotate("text", x = -65, y = 14,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27.5,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 18,
label = c("Southern Taiwan"))
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20)) +
annotate("text", x = 148, y = -13,
label = c("Australia")) +
annotate("text", x = -105, y = 23.8,
label = c("Mexico")) +
annotate("text", x = -65, y = 14,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27.5,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 18,
label = c("Southern Taiwan"))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
# EVI
EVI_map <- ggplot() +
geom_map(data = world, map = world,
aes(long, lat, map_id = region),
color = "black", fill = "white", size = 0.1) +
coord_cartesian(ylim = c(-27.5, 27.5)) +
geom_point(data = VIs_sites,
aes(x = lon, y = lat, color = jitter(change_annual_EVI_250m*100)),
size = 4, alpha = 0.7, position = "jitter") +
labs(y = "Latitude", x = "Longitude", color = PEVI) +
theme_bw() +
theme(legend.position = "right",
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
legend.title = element_text(size = 13, color = "Black"),
legend.text = element_text(size = 13, color = "Black")) +
scale_color_gradient2(midpoint = 0, low = "red", mid = "white",
high = "blue", breaks = c(-60, 0, 20)) +
annotate("text", x = 148, y = -13,
label = c("Australia")) +
annotate("text", x = -105, y = 23.8,
label = c("Mexico")) +
annotate("text", x = -65, y = 14,
label = c("Puerto Rico")) +
annotate("text", x = 120, y = 27.5,
label = c("Central Taiwan")) +
annotate("text", x = 120, y = 18,
label = c("Southern Taiwan"))
# Join figures together and save
map_LAI_EVI <- ggarrange(LAI_map, EVI_map, nrow = 2, ncol = 1,
labels = c("A","B"))
print(map_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 12, height = 6,
path = data_directory, dpi = 300, units = "in")
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
### Stats
## Regressions
# LAI vs log transformed soil P
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.), data = VI)
### Stats
## Regressions
# LAI vs log transformed soil P
LAIsoilP <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.), data = VIs_sites)
names(VIs_sites)
### Stats
## Regressions
# LAI vs log transformed soil P
LAIsoilP <- lm(change_annual_LAI_500m ~ log(soil_P), data = VIs_sites)
summary(LAIsoilP)
tab_model(lme_ndvi)
?tab_model
??tab_model
?tab_model
library(sjPlot)
install.packages("sjPlot")
library(sjPlot)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(sjPlot)
install.packages("sjPlot")
library(sjPlot)
library(sjPlot)
