PEVI = expression(Delta*"EVI annual % (250m)")
PLAI = expression(Delta*"LAI annual % (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "Region", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "Region", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "Region", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
summary(VI.PCA)
summary(VIs_sites)
View(VIs_sites)
View(VI.PCA)
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
LFreco <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"),
stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
VIs_sites2 <- VI_sites %>% filter(annual_EVI_pre_250m != NA)
VIs_sites2 <- VIs_sites %>% filter(annual_EVI_pre_250m != NA)
names(VIs_sites)
head(VIs_sites)
VIs_sites2 <- VIs_sites %>% filter(change_annual_EVI_250m != NA)
summary(VIs_sites$change_annual_EVI_250m)
VIs_sites2 <- VIs_sites %>% filter(change_annual_EVI_250m == NA)
VIs_sites2 <- VIs_sites %>% filter(change_annual_EVI_250m == "NA")
?filter
VI1 <- filter(VIs_sites, change_annual_EVI_250m != NA)
summary(VIs_sites$Latitude)
summary(VIs_sites$Longitude)
summary(VIs_sites$Cyclone_Date)
VIs_sites[1:10,1:10]
VIs_sites[10:20,10:20]
summary(VIs_sites$Cyclone_Year)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
LFreco <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"),
stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
names(VIs_sites)
### Plots
## Figure 2: Point plot of change in EVI and change in LAI
VIs_sites_map <- VIs_sites %>%
mutate(case_study_names = paste(Site, "|", Cyclone_name))
View(VIs_sites_map)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = -0.2, y = -.30,
label = c("Baseline"))
VIs_sites %>%
mutate(case_study_names = paste(Site, "|", Cyclone_name))
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", type = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = -0.2, y = -.30,
label = c("Baseline"))
?geom_vline
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = -0.2, y = -.30,
label = c("Baseline"))
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = -0.2, y = .10,
label = c("Baseline"))
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = -0.2, y = 1,
label = c("Baseline"))
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
names(VIs_sites)
ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# LAI
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(LF_LAI_EVI)
print(Cases_LAI_EVI)
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_blank(),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(Cases_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 7, height = 6,
path = data_directory, dpi = 300, units = "in")
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(Cases_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 7, height = 6,
path = data_directory, dpi = 300, units = "in")
ggsave("NGEE_paper_Fig_2.png", width = 10, height = 6,
path = data_directory, dpi = 300, units = "in")
# LAI
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(Cases_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 11, height = 6,
path = data_directory, dpi = 300, units = "in")
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(webshot)
library(lme4)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(webshot)
library(lme4)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
### Stats
## Regressions
# LAI vs log transformed soil P
LAIsoilP <- lm(change_annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
# Print summary of regression in console
summary(LAIsoilP)
names(VIs_sites)
### Stats
## Regressions
# annual LAI vs log transformed soil P
aLAIsoilP <- lm(change_annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
# Print summary of regression in console
summary(aLAIsoilP)
# Save regression output
tab_model(aLAIsoilP, file = "aLAI_soilP_Reg.html")
# Convert saved html to png
webshot("aLAI_soilP_Reg.html", "aLAI_soilP_Reg.png")
# sub-annual LAI vs log transformed soil P
saLAIsoilP <- lm(change_sub.annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
summary(saLAIsoilP)
tab_model(saLAIsoilP, file = "saLAI_soilP_Reg.html")
webshot("saLAI_soilP_Reg.html", "saLAI_soilP_Reg.png")
# annual EVI vs log transformed soil P
aEVIsoilP <- lm(change_annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(aEVIsoilP)
tab_model(aEVIsoilP, file = "aEVI_soilP_Reg.html")
webshot("aEVI_soilP_Reg.html", "aEVI_soilP_Reg.png")
# sub-annual EVI vs log transformed soil P
saEVIsoilP <- lm(change_sub.annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(saEVIsoilP)
tab_model(saEVIsoilP, file = "saEVI_soilP_Reg.html")
webshot("saEVI_soilP_Reg.html", "saEVI_soilP_Reg.png")
## Mixed effects
# Fixed effects: annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aLAIsoilPC <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aLAIsoilPC)
tab_model(aLAIsoilPC, file = "aLAI_soilP_cyclone_ME.html")
webshot("aLAI_soilP_cyclone_ME.html", "aLAI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saLAIsoilPC <- lmer(change_sub.annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saLAIsoilPC)
tab_model(saLAIsoilPC, file = "saLAI_soilP_cyclone_ME.html")
webshot("saLAI_soilP_cyclone_ME.html", "saLAI_soilP_cyclone_ME.png")
# Fixed effects: annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aEVIsoilPC <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aLAIsoilPC)
tab_model(aLAIsoilPC, file = "aLAI_soilP_cyclone_ME.html")
webshot("aLAI_soilP_cyclone_ME.html", "aLAI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saEVIsoilPC <- lmer(change_sub.annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saLAIsoilPC)
tab_model(saLAIsoilPC, file = "saLAI_soilP_cyclone_ME.html")
webshot("saLAI_soilP_cyclone_ME.html", "saLAI_soilP_cyclone_ME.png")
library(tidyverse)
library(ggpubr)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(webshot)
library(lme4)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
### Stats
## Regressions
# annual LAI vs log transformed soil P
aLAIsoilP <- lm(change_annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
# Print summary of regression in console
summary(aLAIsoilP)
# Save regression output
tab_model(aLAIsoilP, file = "aLAI_soilP_Reg.html")
# Convert saved html to png
webshot("aLAI_soilP_Reg.html", "aLAI_soilP_Reg.png")
# sub-annual LAI vs log transformed soil P
saLAIsoilP <- lm(change_sub.annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
summary(saLAIsoilP)
tab_model(saLAIsoilP, file = "saLAI_soilP_Reg.html")
webshot("saLAI_soilP_Reg.html", "saLAI_soilP_Reg.png")
# annual EVI vs log transformed soil P
aEVIsoilP <- lm(change_annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(aEVIsoilP)
tab_model(aEVIsoilP, file = "aEVI_soilP_Reg.html")
webshot("aEVI_soilP_Reg.html", "aEVI_soilP_Reg.png")
# sub-annual EVI vs log transformed soil P
saEVIsoilP <- lm(change_sub.annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(saEVIsoilP)
tab_model(saEVIsoilP, file = "saEVI_soilP_Reg.html")
webshot("saEVI_soilP_Reg.html", "saEVI_soilP_Reg.png")
## Mixed effects
# Fixed effects: annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aLAIsoilPC <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aLAIsoilPC)
tab_model(aLAIsoilPC, file = "aLAI_soilP_cyclone_ME.html")
webshot("aLAI_soilP_cyclone_ME.html", "aLAI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saLAIsoilPC <- lmer(change_sub.annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saLAIsoilPC)
tab_model(saLAIsoilPC, file = "saLAI_soilP_cyclone_ME.html")
webshot("saLAI_soilP_cyclone_ME.html", "saLAI_soilP_cyclone_ME.png")
# Fixed effects: annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aEVIsoilPC <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aEVIsoilPC)
tab_model(aEVIsoilPC, file = "aEVI_soilP_cyclone_ME.html")
webshot("aEVI_soilP_cyclone_ME.html", "aEVI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saEVIsoilPC <- lmer(change_sub.annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saEVIsoilPC)
tab_model(saEVIsoilPC, file = "saEVI_soilP_cyclone_ME.html")
webshot("saEVI_soilP_cyclone_ME.html", "saEVI_soilP_cyclone_ME.png")
# Site effects on LAI vs log transformed soil phosphorous regression
#LAIsoilPS <- lmer(change_annual_LAI_500m ~ log10(soil_P)
