labs(x = x, y = dLAI1) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
plot.title = element_blank(),
axis.ticks.x = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 7, y = 0.05,
label = c("Baseline"))
## Change in LAI vs soil P scatterplot for comparison
ggplot(VI, aes(x = log(soil.P..mg.kg.), y = change_annual_LAI_500m)) +
geom_point(size = 1) +
geom_smooth(method=lm, se=FALSE, fullrange=FALSE, color = "black") +
stat_cor(method = "pearson", size = 4,
aes(label = paste(..r.label.., ..p.label.., sep = "~`,`~"))) +
xlim(4.2, 7.9) +
labs(x = x, y = dLAI1) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
plot.title = element_blank(),
axis.ticks.x = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 7, y = 0.05,
label = c("Baseline"))
View(VI)
## with log transformation of soil P and wind speed considered
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.) + peak_wind_speed_ms, data = VI)
summary(LAIsoilPln)
## with log transformation of soil P and wind speed considered
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.) * peak_wind_speed_ms, data = VI)
summary(LAIsoilPln)
## LAI and total ground litter fall
LAIaTL <- lm(change_annual_total_litterfall ~ change_annual_LAI_500m, data = VI)
summary(LAIaTL)
## LAI and total ground litter fall
# if one predictor then use regular R-squared, but use adjusted with multiple
LAIaTL <- lm(change_annual_total_litterfall ~ change_annual_LAI_500m, data = VI)
summary(LAIaTL)
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggpmisc)
library(lme4)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
# Dellena file path
data_directory <- '~/Documents/Kueppers lab'
# load data
VI <- read.csv(file.path(data_directory, "case_study_data.csv"), stringsAsFactors = FALSE)
# axis labels
x = expression(paste(ln,"(soil P (mg/kg))"))
dLAI1 = expression(Delta*"LAI annual (500m)")
dLAI2 = expression(Delta*"LAI sub-annual (500m)")
dTL1 = expression(Delta*"TL annual")
## Calculating change in LF
# annual TL
VI$change_annual_total_litterfall = log(VI$Response_Post_Mean_Tot_Litterfall
/ VI$Pre_Mean_Tot_Litterfall_g.m2.day)
# annual LL
VI$change_annual_leaf_litterfall = log(VI$Response_Post_Mean_Leaf_fall
/ VI$Pre_Mean_Leaf_fall)
# sub-annual TL
VI$change_subannual_total_litterfall = log(VI$Response_Post_Mean_Tot_Litterfall
/ VI$Subannual_Pre_mean_Tot_Litterfall)
# sub-annual LL
VI$change_subannual_leaf_litterfall = log(VI$Response_Post_Mean_Leaf_fall
/ VI$Subannual_Pre_Mean_Leaf_fall)
## LAI and total ground litter fall
# if one predictor then use regular R-squared, but use adjusted with multiple
LAIaTL <- lm(change_annual_total_litterfall ~ change_annual_LAI_500m, data = VI)
summary(LAIaTL)
## with log transformation of soil P and wind speed considered
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.) + peak_wind_speed_ms, data = VI)
summary(LAIsoilPln)
## with wind speed and change in LAI
LAIws <- lm(change_annual_LAI_500m ~ peak_wind_speed_ms, data = VI)
summary(LAIws)
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.), data = VI)
summary(LAIsoilPln)
LAIsoilPln <- lm(change_annual_LAI_500m ~ log(soil.P..mg.kg.), data = VI)
summary(LAIsoilPln)
## with wind speed and change in LAI
LAIws <- lm(change_annual_LAI_500m ~ peak_wind_speed_ms, data = VI)
summary(LAIws)
### Organizing Environment
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
# Dellena file path
data_directory <- '~/Documents/Kueppers lab'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"), stringsAsFactors= FALSE)
# axis labels
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
x = "Time since disturbance (months)"
### Timeseries
## Pantropical data calculation
# LAI
LAIm <- recovery %>%
drop_na() %>%
group_by(month) %>%
summarize(m = mean(LAI_change_500m),
SD = sd(LAI_change_500m),
n = length(LAI_change_500m))
LAIm <- merge(LAIm, recovery, by = "month")
error <- qnorm(0.975) * LAIm$SD/sqrt(LAIm$n)
# this is standard error
# .975 if having a normal distribution and .95 if not?
LAIm$min = LAIm$m - error
LAIm$max = LAIm$m + error
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
ggsave("recovery_LAI_500m.png", width = 7, height = 5, path = data_directory)
LAI <- ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = "", y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
print(LAI)
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
#geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.95, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
View(LAIm)
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"), stringsAsFactors= FALSE)
# axis labels
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
# Dellena file path
data_directory <- '~/Documents/Kueppers lab'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"), stringsAsFactors= FALSE)
# axis labels
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
NDVIreco = expression(Delta*"NDVI 250m [NDVI/NDVI]")
x = "Time since disturbance (months)"
### Timeseries
## Pantropical data calculation
# LAI
LAIm <- recovery %>%
drop_na() %>%
group_by(month) %>%
summarize(m = mean(LAI_change_500m),
SD = sd(LAI_change_500m),
n = length(LAI_change_500m))
LAIm <- merge(LAIm, recovery, by = "month")
error <- qnorm(0.975) * LAIm$SD/sqrt(LAIm$n)
# this is standard error
# .975 if having a normal distribution and .95 if not?
LAIm$min = LAIm$m - error
LAIm$max = LAIm$m + error
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(data = LAIm, aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
View(LAIm)
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
#geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
## Plot
# LAI
ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = x, y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
View(LAIm)
LAI <- ggplot(LAIm, aes(x = month, y = LAI_change_500m, group = case_study, color = region)) +
geom_line(data = LAIm[!is.na(LAIm$LAI_change_500m),]) +
geom_ribbon(aes(x = month, ymin = min, ymax = max),
fill = "light blue", alpha = 0.05, color = NA) +
geom_line(aes(x = month, y = m, color = "Pantropical mean")) +
labs(x = "", y = LAIreco, color = "Region") +
ylim(-1.5, 1.5) +
geom_hline(yintercept=c(0), color = "gray") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_text(size = 13, color = "black"),
legend.text = element_text(size = 13, color = "black"),
plot.title = element_blank(),
axis.text.x = element_blank(),
axis.title.x = element_blank(),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 13, color = "black"),
panel.grid.minor = element_blank()) +
guides(color=guide_legend(nrow=2, byrow=TRUE))
print(LAI)
