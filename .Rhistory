# Save regression output
tab_model(aLAIsoilP, file = "aLAI_soilP_Reg.html")
# Convert saved html to png
webshot("aLAI_soilP_Reg.html", "aLAI_soilP_Reg.png")
# sub-annual LAI vs log transformed soil P
saLAIsoilP <- lm(change_sub.annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
summary(saLAIsoilP)
tab_model(saLAIsoilP, file = "saLAI_soilP_Reg.html")
webshot("saLAI_soilP_Reg.html", "saLAI_soilP_Reg.png")
# annual EVI vs log transformed soil P
aEVIsoilP <- lm(change_annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(aEVIsoilP)
tab_model(aEVIsoilP, file = "aEVI_soilP_Reg.html")
webshot("aEVI_soilP_Reg.html", "aEVI_soilP_Reg.png")
# sub-annual EVI vs log transformed soil P
saEVIsoilP <- lm(change_sub.annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(saEVIsoilP)
tab_model(saEVIsoilP, file = "saEVI_soilP_Reg.html")
webshot("saEVI_soilP_Reg.html", "saEVI_soilP_Reg.png")
## Mixed effects
# Fixed effects: annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aLAIsoilPC <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aLAIsoilPC)
tab_model(aLAIsoilPC, file = "aLAI_soilP_cyclone_ME.html")
webshot("aLAI_soilP_cyclone_ME.html", "aLAI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual LAI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saLAIsoilPC <- lmer(change_sub.annual_LAI_500m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saLAIsoilPC)
tab_model(saLAIsoilPC, file = "saLAI_soilP_cyclone_ME.html")
webshot("saLAI_soilP_cyclone_ME.html", "saLAI_soilP_cyclone_ME.png")
# Fixed effects: annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
aEVIsoilPC <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(aEVIsoilPC)
tab_model(aEVIsoilPC, file = "aEVI_soilP_cyclone_ME.html")
webshot("aEVI_soilP_cyclone_ME.html", "aEVI_soilP_cyclone_ME.png")
# Fixed effects: sub-annual EVI vs log transformed soil phosphorous
# Mixed effects: Wind speed
saEVIsoilPC <- lmer(change_sub.annual_EVI_250m ~ log10(soil_P) + (1|peak_wind_speed_ms),
data = VIs_sites)
summary(saEVIsoilPC)
tab_model(saEVIsoilPC, file = "saEVI_soilP_cyclone_ME.html")
webshot("saEVI_soilP_cyclone_ME.html", "saEVI_soilP_cyclone_ME.png")
# Site effects on LAI vs log transformed soil phosphorous regression
#LAIsoilPS <- lmer(change_annual_LAI_500m ~ log10(soil_P)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
LFreco <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"),
stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
### Plots
## Figure 2: Point plot of change in EVI and change in LAI
# Adding case study column with site and cyclone name
VIs_sites_map <- VIs_sites %>%
mutate(case_study_names = paste(Site, "|", Cyclone_name))
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Site)) +
geom_point(size = 3)
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3, color = "red")
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3, color = "red") +
geom_point(data = VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site), size = 3, color = "blue")
## LAI and EVI together
# Plot
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3, color = "red") +
geom_point(data = VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site), size = 3, color = "blue") +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Plot
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3, color = "red") +
geom_point(data = VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site), size = 3, color = "blue") +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
#legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Plot
ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names)) +
geom_point(size = 3, color = "red") +
geom_point(data = VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site), size = 3, color = "blue") +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
#legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value")
View(VIs_sites_VIcombos)
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = c,
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
#legend.position = ,
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value") %>%
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.title = element_blank(),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value") %>%
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw()
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank())
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value") %>%
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value") %>%
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1, label = c("Baseline"))
?rename
## LAI and EVI together
# Making column with both LAI and EVI
VIs_sites_VIcombos <- VIs_sites_map %>%
pivot_longer(cols = c(change_annual_EVI_250m, change_annual_LAI_500m),
names_to = "VIs", values_to = "value") %>%
rename(VIs, c("change_annual_EVI_250m" = "EVI"))
VIs_sites_VIcombos["VIs"][VIs_sites_VIcombos["VIs"] == "change_annual_EVI_250m"] <-
expression(Delta*"EVI annual (250m)")
VIs_sites_VIcombos["VIs"][VIs_sites_VIcombos["VIs"] == "change_annual_EVI_250m"] <- EVI
VIs_sites_VIcombos["VIs"][VIs_sites_VIcombos["VIs"] == "change_annual_EVI_250m"] <- "Change in EVI (250m)"
VIs_sites_VIcombos["VIs"][VIs_sites_VIcombos["VIs"] == "change_annual_LAI_500m"] <- "Change in LAI (500m)"
View(VIs_sites_VIcombos)
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1, label = c("Baseline"))
# Save figure
ggsave("NGEE_paper_Fig_2_v2.png", width = 5, height = 6,
path = data_directory, dpi = 300, units = "in")
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.text = element_text(size = 13, color = "Black"),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1, label = c("Baseline"))
# Plot
ggplot(VIs_sites_VIcombos, aes(x = value, y = case_study_names, color = VIs)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI, color = "") +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "top",
legend.text = element_text(size = 13, color = "Black"),
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1, label = c("Baseline"))
# Save figure
ggsave("NGEE_paper_Fig_2_v2.png", width = 5, height = 6,
path = data_directory, dpi = 300, units = "in")
# Save figure
ggsave("NGEE_paper_Fig_2_v2.png", width = 8, height = 6,
path = data_directory, dpi = 300, units = "in")
# Save figure
ggsave("NGEE_paper_Fig_2_v2.png", width = 8, height = 6,
path = data_directory, dpi = 300, units = "in")
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
LFreco <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"),
stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
### Plots
## Figure 2: Point plot of change in EVI and change in LAI
# Adding case study column with site and cyclone name
VIs_sites_map <- VIs_sites %>%
mutate(case_study_names = paste(Site, "|", Cyclone_name))
# LAI
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Site)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# LAI
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Region)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Region)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(Cases_LAI_EVI)
### Plots
## Figure 2: Point plot of change in EVI and change in LAI
# Adding case study column with site and cyclone name
VIs_sites_map <- VIs_sites %>%
mutate(case_study_names = paste(Site, "|", Cyclone_name))
# LAI
LAI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_LAI_500m, y =
case_study_names, color = Region)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = LAI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.25, y = 1,
label = c("Baseline"))
# EVI
EVI_cases <- ggplot(VIs_sites_map, aes(x = change_annual_EVI_250m, y =
case_study_names, color = Region)) +
geom_point(size = 3) +
geom_vline(xintercept=c(0), color = "gray", linetype = "dashed") +
labs(y = "", x = EVI) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
legend.position = "none",
axis.title = element_text(size = 13, color = "Black"),
axis.text = element_text(size = 13, color = "Black"),
panel.grid.minor = element_blank()) +
annotate("text", x = 0.2, y = 1,
label = c("Baseline"))
# Join figures together and save
Cases_LAI_EVI <- ggarrange(LAI_cases, EVI_cases, nrow = 1, ncol = 2,
labels = c("A","B"))
print(Cases_LAI_EVI)
ggsave("NGEE_paper_Fig_2.png", width = 11, height = 6,
path = data_directory, dpi = 300, units = "in")
