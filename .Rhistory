stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
# Percent change in LAI and EVI
PEVI = expression(Delta*"EVI annual % (250m)")
PLAI = expression(Delta*"LAI annual % (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
library(ggpubr)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(webshot)
library(lme4)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~ 1|Site, ~1|Cyclone),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~1|Cyclone),
data = VIs_sites)
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
### Stats
## Regressions
# LAI vs log transformed soil P
LAIsoilP <- lm(change_annual_LAI_500m ~ log10(soil_P), data = VIs_sites)
# Print summary of regression in console
summary(LAIsoilP)
# EVI vs log transformed soil P
EVIsoilP <- lm(change_annual_EVI_250m ~ log10(soil_P), data = VIs_sites)
summary(EVIsoilP)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~1|Cyclone),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone),
data = VIs_sites)
names(VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~ 1|Site, ~1|Cyclone_name),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~1|Cyclone_name),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Site and cyclone
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
summary(LAIsoilPWS)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Cyclone name
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Cyclone name
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (~1|Cyclone_name),
data = VIs_sites)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Cyclone name
LAIsoilPWS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
summary(LAIsoilPWS)
tab_model(LAIsoilPWS, file = "LAI_soilP_wind_ME.html")
webshot("LAI_soilP_wind_ME.html", "LAI_soilP_wind_ME.png")
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Cyclone name
LAIsoilPC <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
summary(LAIsoilPC)
tab_model(LAIsoilPC, file = "LAI_soilP_cyclone_ME.html")
webshot("LAI_soilP_cyclone_ME.html", "LAI_soilP_cyclone_ME.png")
# Site effects on LAI vs log transformed soil phosphorous regression
LAIsoilPS <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Site),
data = VIs_sites)
summary(LAIsoilPS)
tab_model(LAIsoilPS, file = "LAI_soilP_site_ME.html")
webshot("LAI_soilP_site_ME.html", "LAI_soilP_site_ME.png")
# Determine best LAI mixed effects model using AIC
AIC(LAIsoilPC)
AIC(LAIsoilPS)
# Cyclone name effects on EVI vs log transformed soil phosphorous regression
EVIsoilPC <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
summary(EVIsoilPC)
tab_model(EVIsoilPC, file = "EVI_soilP_cyclone_ME.html")
webshot("EVI_soilP_cyclone_ME.html", "EVI_soilP_cyclone_ME.png")
# Site effects on EVI vs log transformed soil phosphorous regression
EVIsoilPS <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|Site),
data = VIs_sites)
summary(EVIsoilPS)
tab_model(EVIsoilPS, file = "EVI_soilP_site_ME.html")
webshot("EVI_soilP_site_ME", "EVI_soilP_site_ME.png")
webshot("EVI_soilP_site_ME.html", "EVI_soilP_site_ME.png")
# Determine best EVI mixed effects model using AIC
AIC(EVIsoilPC)
AIC(EVIsoilPS)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
# Percent change in LAI and EVI
PEVI = expression(Delta*"EVI annual % (250m)")
PLAI = expression(Delta*"LAI annual % (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor(Parent_material)
names(VIs_sites)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor("Parent_material")
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- VIs_sites %>%
as.factor("Parent_material")
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- VIs_sites %>%
as.factor(Parent_material)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor("Parent_material")
names(VIs_sites)
view(VIs_sites$Parent_material_ID)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor(VIs_sites$Parent_material)
View(VIs_sites)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor(VIs_sites$Parent_material) %>%
as.numeric()
View(VIs_sites)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor(VIs_sites$Parent_material) #%>%
View(VIs_sites)
## Figure 6: PCA results for LAI and EVI
# LAI
# Adding column for parent material numeric ID's
VIs_sites$Parent_material_ID <- as.factor(VIs_sites$Parent_material) %>%
as.numeric()
View(VIs_sites)
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material_ID", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
# adds numeric factor column for parent material
VI2 <- transform(VI.PCA, Parent_material_ID = as.numeric
(factor(Parent_material)))
# select only numeric columns and remove parent materials
VI2.PCA <- VI2[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material_ID", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm")]
# rename columns
VI2.PCA <- dplyr::rename(VI2.PCA, "change annual LAI (500m)" =
change_annual_LAI_500m)
VI2.PCA <- dplyr::rename(VI2.PCA, "Holdridge Life Zone" = Holdridge_ID)
VI2.PCA <- dplyr::rename(VI2.PCA, "soil phosphorus" = soil_P)
VI2.PCA <- dplyr::rename(VI2.PCA, "wind duration" =
gale.wind.duration..minutes.)
VI2.PCA <- dplyr::rename(VI2.PCA, "wind speed" = peak_wind_speed_ms)
VI2.PCA <- dplyr::rename(VI2.PCA, "change TL" = change_annual_total_litterfall)
VI2.PCA <- dplyr::rename(VI2.PCA, "years since last storm" =
Years_since_last_storm)
VI2.PCA <- dplyr::rename(VI2.PCA, "elevation" = Elevation_m)
VI2.PCA <- dplyr::rename(VI2.PCA, "cyclone frequency" = Cyclone_frequency)
VI2.PCA <- dplyr::rename(VI2.PCA, "parent material" = Parent_material_ID)
VI2.PCA <- dplyr::rename(VI2.PCA, "MAT:MAP ratio" = MAT_MAP_ratio_X100)
VI2.PCA <- dplyr::rename(VI2.PCA, "cyclone rainfall" = Cyclone_Rainfall_mm)
# compute PCA
VI.pca <- prcomp(VI2.PCA, scale = TRUE)
View(VI.PCA)
View(VI.pca)
# compute eigenvalue for variable selection
eigenvalue <- VI.pca$sdev ^ 2
view(eigenvalue)
# sleect for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1
view(eigenvalue2)
# sleect for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1 %>%
filter(TRUE)
# sleect for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1 %>%
filter("TRUE")
# sleect for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1 %>%
select("TRUE")
eigenvalue2 <- eigenvalue2 %>%
filter("TRUE")
eigenvalue2 <- eigenvalue2 %>%
filter(1)
eigenvalue2 <- eigenvalue2 %>%
as.numeric()
eigenvalue2 <- eigenvalue2 %>%
as.numeric() %>%
filter(1)
eigenvalue2 <- eigenvalue2 %>%
as.numeric() %>%
eigenvalue2 == 1
eigenvalue2 <- eigenvalue2 %>%
as.numeric() %>%
filter(eigenvalue2 == 1)
# sleect for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1
eigenvalue3 <- eigenvalue2 %>%
as.numeric()
eigenvalue4 <- eigenvalue3 == 1
View(VI.pca)
view(VI.pca$x)
view(VI.pca$sdev)
view(VI.pca$rotation)
View(VI2.PCA)
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude")] # , "gale.wind.duration..minutes.",
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
# select only numeric columns and remove parent materials
VI2.PCA <- VI2[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude")] #, "gale.wind.duration..minutes.",
# rename columns
VI2.PCA <- dplyr::rename(VI2.PCA, "change annual LAI (500m)" =
change_annual_LAI_500m)
VI2.PCA <- dplyr::rename(VI2.PCA, "Holdridge Life Zone" = Holdridge_ID)
VI2.PCA <- dplyr::rename(VI2.PCA, "soil phosphorus" = soil_P)
# compute PCA
VI.pca <- prcomp(VI2.PCA, scale = TRUE)
# compute eigenvalue for variable selection
eigenvalue <- VI.pca$sdev ^ 2
# select for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1
# include countries from VI2 in the order that they appear in the csv
country <- c(rep("Caribbean", 2), rep("Mexico", 2), rep("Caribbean", 4),
rep("Taiwan", 8), rep("Caribbean", 2), "Australia")
print(country)
# plot
LAI_PCA <- ggbiplot(VI.pca, ellipse = TRUE, obs.scale = 1, var.scale = 1,
groups = country) +
labs(color = "Region") +
ylim(-5.2, 4.1) +
xlim(-4.2, 5.5) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
axis.title = element_text(size = 13, color = "black"),
axis.text = element_text(size = 12, color = "black"),
legend.position = "none",
legend.text = element_text(size = 13, color = "black"),
legend.title = element_text(size = 13, color = "black"))
install.packages("ggbiplot")
library(ggbiplot)
# plot
LAI_PCA <- ggbiplot(VI.pca, ellipse = TRUE, obs.scale = 1, var.scale = 1,
groups = country) +
labs(color = "Region") +
ylim(-5.2, 4.1) +
xlim(-4.2, 5.5) +
theme_bw() +
theme(panel.background = element_blank(),
panel.grid.major = element_blank(),
axis.title = element_text(size = 13, color = "black"),
axis.text = element_text(size = 12, color = "black"),
legend.position = "none",
legend.text = element_text(size = 13, color = "black"),
legend.title = element_text(size = 13, color = "black"))
## Figure 6: PCA results for LAI and EVI
# LAI
# selecting columns
VI.PCA <- VIs_sites[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm", "Region", "N")]
# drop NAs
VI.PCA <- VI.PCA %>%
drop_na()
# select only numeric columns and remove parent materials
VI2.PCA <- VI2[,c("change_annual_LAI_500m", "Holdridge_ID", "soil_P",
"Longitude", "gale.wind.duration..minutes.",
"peak_wind_speed_ms", "change_annual_total_litterfall",
"Years_since_last_storm", "Elevation_m", "Cyclone_frequency",
"Parent_material_ID", "MAT_MAP_ratio_X100",
"Cyclone_Rainfall_mm")]
# rename columns
VI2.PCA <- dplyr::rename(VI2.PCA, "change annual LAI (500m)" =
change_annual_LAI_500m)
VI2.PCA <- dplyr::rename(VI2.PCA, "Holdridge Life Zone" = Holdridge_ID)
VI2.PCA <- dplyr::rename(VI2.PCA, "soil phosphorus" = soil_P)
VI2.PCA <- dplyr::rename(VI2.PCA, "wind duration" =
gale.wind.duration..minutes.)
VI2.PCA <- dplyr::rename(VI2.PCA, "wind speed" = peak_wind_speed_ms)
VI2.PCA <- dplyr::rename(VI2.PCA, "change TL" = change_annual_total_litterfall)
VI2.PCA <- dplyr::rename(VI2.PCA, "years since last storm" =
Years_since_last_storm)
VI2.PCA <- dplyr::rename(VI2.PCA, "elevation" = Elevation_m)
VI2.PCA <- dplyr::rename(VI2.PCA, "cyclone frequency" = Cyclone_frequency)
VI2.PCA <- dplyr::rename(VI2.PCA, "parent material" = Parent_material_ID)
VI2.PCA <- dplyr::rename(VI2.PCA, "MAT:MAP ratio" = MAT_MAP_ratio_X100)
VI2.PCA <- dplyr::rename(VI2.PCA, "cyclone rainfall" = Cyclone_Rainfall_mm)
# compute PCA
VI.pca <- prcomp(VI2.PCA, scale = TRUE)
# compute eigenvalue for variable selection
eigenvalue <- VI.pca$sdev ^ 2
# select for eigenvalue > 1
eigenvalue2 <- eigenvalue > 1
# include countries from VI2 in the order that they appear in the csv
country <- c(rep("Caribbean", 2), rep("Mexico", 2), rep("Caribbean", 4),
rep("Taiwan", 8), rep("Caribbean", 2), "Australia")
print(country)
View(VI2)
View(VI.pca)
VI.pca[1:4,]
VI.pca$x[1:4,]
View(VI.pca)
VI.pca
VI.pca[,1:4]
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(webshot)
library(lme4)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Mixed effects
# Fixed effects: LAI vs log transformed soil phosphorous
# Mixed effects: Cyclone name
LAIsoilPC <- lmer(change_annual_LAI_500m ~ log10(soil_P) + (1|Cyclone_name),
data = VIs_sites)
summary(LAIsoilPC)
tab_model(LAIsoilPC, file = "LAI_soilP_cyclone_ME.html")
EVIsoilPS <- lmer(change_annual_EVI_250m ~ log10(soil_P) + (1|Site),
data = VIs_sites)
summary(EVIsoilPS)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(multcompView)
library(ggcorrplot)
library(factoextra)
library(ggbiplot)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
recovery <- read.csv(file.path(data_directory, "MODIS_recovery.csv"),
stringsAsFactors= FALSE, na.strings = '-9999')
LFreco <- read.csv(file.path(data_directory, "MODIS_recovery_bb.csv"),
stringsAsFactors= FALSE)
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
## Axis labels
# Change in LAI and EVI
EVI = expression(Delta*"EVI annual (250m)")
LAI = expression(Delta*"LAI annual (500m)")
# Percent change in LAI and EVI
PEVI = expression(Delta*"EVI annual % (250m)")
PLAI = expression(Delta*"LAI annual % (500m)")
# Litter fall
dTL1 = expression(Delta*"TL annual")
dLL1 = expression(Delta*"LL annual")
# Recovery
LAIreco = expression(Delta*"LAI 500m [LAI/LAI]")
EVIreco = expression(Delta*"EVI 250m [EVI/EVI]")
time = "Time since disturbance (months)"
# Soil phosphorus
sP = expression(paste(log[10],"(soil P (mg/kg))"))
## Calculating change in litter fall
# annual total litter fall
VIs_sites$change_annual_total_litterfall = log(
VIs_sites$Response_Post_Mean_Tot_Litterfall/
VIs_sites$Pre_Mean_Tot_Litterfall_g.m2.day)
### Organizing Environment
## Load packages and data
# load packages
library(tidyverse)
library(ggpubr)
library(sjPlot)
library(sjlabelled)
library(webshot)
library(lme4)
# Dellena file path
#data_directory <- '~/Documents/Kueppers lab'
data_directory <- 'private/data'
# load data
VIs_sites <- read.csv(file.path(data_directory, "case_study_data.csv"),
stringsAsFactors= FALSE, na.strings = '-9999') %>%
drop_na(change_annual_LAI_500m)
names(VIs_sites)
unique(VIs_sites$Site)
unique(VIs_sites$Cyclone_name)
